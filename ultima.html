<!DOCTYPE html>
<html lang="pt-BR">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Layout Minimalista (Status)</title>
    <link rel="stylesheet" href="ultima.css">
</head>

<body>

    <div class="app-header">
        <a href="cards.html" class="header-item header-left">Fechar</a>
        <div class="header-item header-center"><span id="docText">Frente</span></div>
        <div class="header-item header-right">...</div>
    </div>

    <div class="status-content">
        <div class="status-message">
            <span class="status-icon"><img width="40px" src="img/check.png" alt=""></span>
            <span id="tempoAtualizado">Atualizado em ...</span>
        </div>
        <div class="progress-container">
    <div class="progress-fill" id="progress-bar" style="width: 0%;"></div>
</div>
    </div>

    <div class="doc">
            <img src="svg/id.front.svg" id="docImg" alt="">
    </div>

    <div class="tab-bar-icons">
        <span class="tab-icon-item active">
            <img src="img/frente.png" alt="">
            <img src="img/atras.png" alt="">
            <img src="img/qr.png" alt="">
    </div>

</body>

<script>
document.addEventListener('touchmove', function (e) {
    e.preventDefault();
}, { passive: false });

// Atualiza o tempo de carregamento
const tempoElemento = document.getElementById('tempoAtualizado');
const agora = new Date();
const dia = String(agora.getDate()).padStart(2, '0');
const mes = String(agora.getMonth() + 1).padStart(2, '0');
const ano = agora.getFullYear();
const hora = String(agora.getHours()).padStart(2, '0');
const minutos = String(agora.getMinutes()).padStart(2, '0');
tempoElemento.textContent = `Atualizado em ${dia}/${mes}/${ano} às ${hora}:${minutos}`;

// Configuração do carrossel
const docImg = document.getElementById('docImg');
const docText = document.getElementById('docText');

const imagens = ['svg/id.front.svg', 'svg/id.back.svg', 'img/qrr.png'];
const textos = ['Frente', 'Verso', 'QR Code'];
let index = 0;

let startX = 0;

// Barra de progresso
const progressBarContainer = document.querySelector('.progress-container');
const progressBar = document.getElementById('progress-bar');
let progress = 0;
let interval = null;

// Função para atualizar a barra
function updateProgress() {
    progress += 10;
    if(progress <= 100){
        progressBar.style.width = progress + '%';
    } else {
        progressBar.style.width = '100%';
        clearInterval(interval);
        setTimeout(() => {
            progress = 0;
            progressBar.style.width = '0%';
            interval = setInterval(updateProgress, 1000);
        }, 3000);
    }
}

// Função para trocar imagem com fade
function trocarImagem(index) {
    // Esmaecer a imagem atual
    docImg.style.opacity = 0;

    setTimeout(() => {
        // Troca a imagem e o texto
        docImg.src = imagens[index];
        docText.textContent = textos[index];

        // Aparecer a nova imagem
        docImg.style.opacity = 1;
    }, 300); // metade do tempo de transição
}

// Início do toque na imagem
docImg.addEventListener('touchstart', (e) => {
    startX = e.touches[0].clientX;
});

// Fim do toque na imagem
docImg.addEventListener('touchend', (e) => {
    const endX = e.changedTouches[0].clientX;
    const diff = endX - startX;

    if(diff < -30 || diff > 30){ // swipe detectado
        index = (index + 1) % imagens.length; // próxima imagem/texto
        trocarImagem(index);

        // Mostrar barra de progresso apenas no QR code
        if(imagens[index] === 'img/qrr.png'){
            progressBarContainer.style.display = 'block';
            progress = 0;
            progressBar.style.width = '0%';
            if(interval) clearInterval(interval);
            interval = setInterval(updateProgress, 1000);
        } else {
            progressBarContainer.style.display = 'none';
            progressBar.style.width = '0%';
            if(interval) clearInterval(interval);
        }
    }
});

function trocarImagem(index) {
    // Esmaecer a imagem atual
    docImg.style.opacity = 0;

    setTimeout(() => {
        // Troca a imagem e o texto
        docImg.src = imagens[index];
        docText.textContent = textos[index];

        // Ajusta o tamanho dependendo da imagem
        if (imagens[index] === 'img/qrr.png') {
            docImg.style.width = "100%";  // reduz só o QR
            docImg.style.height = "auto";
        } else {
            docImg.style.width = "";   // remove estilo forçado
            docImg.style.height = "";
        }

        // Aparecer a nova imagem
        docImg.style.opacity = 1;
    }, 100);
}


</script>





</html>